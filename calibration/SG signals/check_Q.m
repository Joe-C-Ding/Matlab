close all
home

start_test = tic;

%{
% original from Lucchini
% E1 =  1.6123e+007, E2 =  1.7052e+007
U = -1 * [
	 0.1690	-0.4563	0.5497	-1.3940	0.6637	-0.1108	0.0276
    -0.0932	 0.0089	0.5259	-1.0392	0.3970	-0.4302	0.1221
];

% E1 =  2.9867e+005, E2 =  2.2056e+005  %% that is just a test!!
U = [
  -0.050939083819804   0.175044216481845  -0.667494955746191   1.664100703536877  -0.449677372867848  -0.144024325161983   0.137728756988813
  -0.184149036743590   0.354363316852575   0.352871371535977  -0.874375408100500   0.354857834801296   0.086223561266610   0.139192192024845
];

% E1 =  1.1368e+007, E2 = 6.1269e+006
U = [
  -0.256487550368357   0.512827795093346  -0.238727206564595   0.759316013075749  -0.375927813358247  -0.027934405381411   0.085625450664008
  -0.023894640728038   0.099542188784322  -0.423343737440986   0.856379891508525  -0.317929442563568   0.189014460685575   0.102638322667198
];

% E1 = 1.1155e+07, E2 = 6.0808e+06
U = [
  -0.248642435161085   0.515963619379173  -0.300527636665368   0.882454823291273  -0.439129985110215  -0.034840514788910   0.103366362103253
  -0.028182950608210   0.107037947268777  -0.435210617586924   0.881963102082784  -0.331330789723883   0.177935732623631   0.113946602259114
];

% E1 = 1.6974e+07, E2 = 9.8757e+07
U = [
  -0.266535846567683   0.502323997604268   0.102441120214530  -0.005130328706506   0.006044198036084
  -0.214751295963397   0.175085265150728   1.016552445513806  -2.243694814278813   1.259899201407075
];
%}
%%
files = {
    'AAAA071.mat'	%1
    'AAAA072.mat'	%2
    'AAAA074.mat'	%3
    'AAAA075.mat'	%4
    'AAAA076.mat'	%5
    'AAAA078.mat'	%6
    'AAAA080.mat'	%7
    'AAAA123.mat'	%8
    'AAAA126.mat'	%9
    'AAAA127.mat'	%10
    'AAAA128.mat'	%11
    'AAAA131.mat'	%12
};

T = [];
mt = 0;

QC = [];
WC = [];

%%
for i = 1:length(files);
    load(files{i}, 'Time', 'WQ', 'WA');
    T = [T; mt + Time];
    mt = T(end);
    
    QC = [QC; WQ];
    WC = [WC; WA(:,1:6)];
end

%
QS = WC * U';

E = QS - QC;
E1 = E(:,1)' * E(:,1)
E2 = E(:,2)' * E(:,2)


subplot(2,1,1)
plot(T,QS(:,1),'g', T,QC(:,1),'k'),grid
% axis ([0 Time(end) min(QC(:,1))-5 max(QC(:,1))+5])
xlabel('Time [s]'),ylabel('[kN]'),legend('Q1 calc','Q1 real')

subplot(2,1,2)
plot(T,QS(:,2),'r',T,QC(:,2),'k'),grid
% axis ([0 Time(end) min(QC(:,2))-5 max(QC(:,2))+5])
xlabel('Time [s]'),ylabel('[kN]'),legend('Q2 calc','Q2 real', 'Location', 'SE')

toc(start_test);