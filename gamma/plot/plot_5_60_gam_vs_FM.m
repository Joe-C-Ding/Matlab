start_test = tic;
figure(1);
clf; ax = gca;

bN = 1.0e+07 * [
                   0   0.000000500000000
   0.037060900000000   0.000000510898014
   0.074060900000000   0.000000522625628
   0.111060900000000   0.000000535278369
   0.148060900000000   0.000000548857545
   0.185072200000000   0.000000563485567
   0.222111000000000   0.000000579221736
   0.259111000000000   0.000000596305858
   0.296111000000000   0.000000614774567
   0.333122500000000   0.000000634878686
   0.370172300000000   0.000000656753938
   0.407172300000000   0.000000680902459
   0.444172300000000   0.000000707811864
   0.481172300000000   0.000000738050709
   0.518200000000000   0.000000771979988
   0.555200000000000   0.000000810271142
   0.592260900000000   0.000000853807021
   0.629260900000000   0.000000903360212
   0.666260900000000   0.000000960089682
   0.703260900000000   0.000001025457914
   0.740260900000000   0.000001100991018
   0.777272200000000   0.000001188953556
   0.814311000000000   0.000001291701450
   0.851311000000000   0.000001413983822
   0.888311000000000   0.000001561055900
   0.925322500000000   0.000001739359971
   0.962372300000000   0.000001957593882
   0.999372300000000   0.000002227271499
   1.036372300000000   0.000002562839995
   1.073372300000000   0.000002983696581
   1.110400000000000   0.000003519781904
   1.147400000000000   0.000004209246796
   1.184460900000000   0.000005108663240
   1.213260900000000   0.000006000571917
];

% [a, b, l] = estgamma3( compress(bN, 10) );
a = 7.363088589086989e-22;
b = 3.204347970248095;
l = 0.670048819136999;

clf;
plot(bN(:,1), bN(:,2), 'k');
hold on;

gammapath2(a, l, b, 5, 60, 3);
axis([1e6 2e7 5 60]);
set(gca, 'XScale', 'log');

h = findobj(gca, 'type', 'line');
for i = 1:length(h)
    if get(h(i), 'color') == [0 0 0]
        continue
    end
    
    dx = get(h(i), 'XData');
    dx = compress(dx, 100);
    dy = get(h(i), 'YData');
    dy = compress(dy, 100);
    
    delete(h(i));
    h(i) = plot(dx, dy);
end

legend(sprintf('a=%.4g\nb=%.4f\nl=%.4f', a, b, l), 'location', 'northwest');

toc(start_test);